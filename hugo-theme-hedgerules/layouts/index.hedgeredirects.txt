{{- /* The _hedge_redirects.txt file template.

Outputs a redirects file that Hedgerules reads.
Each line: /source /destination

Sources:
1. Site-wide custom redirects from params.HedgerulesRedirects
2. Hugo aliases from page frontmatter
3. Per-page path redirects from HedgerulesPathRedirects frontmatter

Directory index redirects (/path -> /path/) are NOT included here;
Hedgerules generates those by scanning the build output.

*/ -}}
# Redirects generated by Hugo
# Format: /source /destination
# Site-wide custom redirects
{{ range $source, $dest := .Site.Params.HedgerulesRedirects -}}
{{ $source }} {{ $dest }}
{{ end -}}
# Hugo aliases and per-page path redirects
{{- range .Site.AllPages -}}
  {{- $dest := .RelPermalink -}}
  {{- range .Aliases }}
{{ . }} {{ $dest }}
  {{- end -}}
  {{- range .Params.HedgerulesPathRedirects }}
    {{- $to := .to -}}
    {{- if hasPrefix $to "/" -}}
{{ .from }} {{ $to }}
    {{- else -}}
{{ .from }} {{ printf "%s%s" $dest $to }}
    {{- end -}}
  {{- end -}}
{{- end }}
